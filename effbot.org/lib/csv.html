<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>csv</title>
<style type='text/css'>body { font: 100% Georgia, Times, serif; } a.nav:link, a.nav:visited { color: #88f; } .nav { color: #88f; } a.nav:hover { color: blue; } .mark { color: #048444; }</style>
<meta http-equiv='Content-Type' content='text/html;charset=utf-8' />
</head><body>
<table style='font-size: 8pt; background: #efe; padding: 5px; border: 1px solid #084; margin: 0px 0px 20px 0px;' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td align='left'>
an alternative python reference (<a href='/zone/pythondoc-lib.htm'>in progress</a>)
</td><td align='right'>
<a href='http://docs.python.org/lib/module-csv.html'>original</a> :::
<a href='csv.txt'>source</a> :::
<a href='/lib/index.html'>index</a>
</td></tr></table><table style='font-size: 8pt; background: white; padding: 5px; border: 1px solid #084; margin: 0px 0px 20px 0px;' border='0' cellspacing='0' cellpadding='0' width='100%%'><tr><td align='left'>
<b>note:</b> this page has been automatically converted from python.org
sources, and may contain errors and omissions introduced by the conversion
process.
</td></tr></table><div class="body"><div class="module">
<h1>csv&#8212;CSV File Reading and Writing</h1>

<div class="toc"><dl><dt>On this page:</dt><dd><a href="#module-contents">Module Contents</a></dd><dd><a href="#dialects-and-formatting-parameters">Dialects and Formatting Parameters</a></dd><dd><a href="#reader-objects">Reader Objects</a></dd><dd><a href="#writer-objects">Writer Objects</a></dd><dd><a href="#examples">Examples</a></dd></dl></div><p>New in version 2.3.</p>

<p>The so-called CSV (Comma Separated Values) format is the most
common import and export format for spreadsheets and databases.
There is no &#8220;CSV standard&#8221;, so the format is
operationally defined by the many applications which read and write
it. The lack of a standard means that subtle differences often
exist in the data produced and consumed by different applications.
These differences can make it annoying to process CSV files from
multiple sources. Still, while the delimiters and quoting
characters vary, the overall format is similar enough that it is
possible to write a single module which can efficiently manipulate
such data, hiding the details of reading and writing the data from
the programmer.</p>

<p>The <code>csv</code> module implements
classes to read and write tabular data in CSV format. It allows
programmers to say, &#8220;write this data in the format preferred
by Excel,&#8221; or &#8220;read data from this file which was
generated by Excel,&#8221; without knowing the precise details of
the CSV format used by Excel. Programmers can also describe the CSV
formats understood by other applications or define their own
special-purpose CSV formats.</p>

<p>The <code>csv</code> module's <a class="link" href="#reader"><code>reader</code></a> and <a class="link" href="#writer"><code>writer</code></a> objects read and write sequences.
Programmers can also read and write data in dictionary form using
the <a class="link" href="#DictReader"><code>DictReader</code></a> and <a class="link" href="#DictWriter"><code>DictWriter</code></a> classes.</p>

<p class="note"><b>Note:</b> This version of the <code>csv</code> module doesn't support Unicode input. Also,
there are currently some issues regarding ASCII NUL characters.
Accordingly, all input should generally be printable ASCII to be
safe. These restrictions will be removed in the future. <span class="mark">@see</span> <a class="link" href="http://www.python.org/peps/pep-0305.html">PEP 305, CSV File
API</a> The Python Enhancement Proposal which proposed this
addition to Python.</p>

<h2 id="module-contents">Module Contents <a class="nav" href="#module-contents">#</a></h2>

<p>The <code>csv</code> module defines the
following functions:</p>
</div>
<dl><dt class="function" id="reader"><b>reader(csvfile[, dialect='excel'[,
fmtparam]])</b> <tt class="nav"><a class="nav" href="csv.reader" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Return a reader object which will iterate over lines in the
given <var>csvfile</var>. <var>csvfile</var> can be any object
which supports the iterator protocol and returns a string each time
its <code>next</code> method is called. If
<var>csvfile</var> is a file object, it must be opened with the 'b'
flag on platforms where that makes a difference. An optional <var>
dialect</var> parameter can be given which is used to define a set
of parameters specific to a particular CSV dialect. It may be an
instance of a subclass of the <a class="link" href="#Dialect"><code>
Dialect</code></a> class or one of the strings returned by the <a class="link" href="#list_dialects"><code>list_dialects</code></a> function.
The other optional <var>fmtparam</var> keyword arguments can be
given to override individual formatting parameters in the current
dialect. For more information about the dialect and formatting
parameters, see section <code>
csv-fmt-params.html#csv-fmt-params</code>, &#8220;Dialects and
Formatting Parameters&#8221; for details of these parameters.</p>

<p>All data read are returned as strings. No automatic data type
conversion is performed.</p>
</dd>
<dt class="function" id="writer"><b>writer(csvfile[, dialect='excel'[,
fmtparam]])</b> <tt class="nav"><a class="nav" href="csv.writer" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Return a writer object responsible for converting the user's
data into delimited strings on the given file-like object. <var>
csvfile</var> can be any object with a <code>write</code> method. If <var>csvfile</var> is a file
object, it must be opened with the 'b' flag on platforms where that
makes a difference. An optional <var>dialect</var> parameter can be
given which is used to define a set of parameters specific to a
particular CSV dialect. It may be an instance of a subclass of the
<a class="link" href="#Dialect"><code>Dialect</code></a> class or one of the
strings returned by the <a class="link" href="#list_dialects"><code>
list_dialects</code></a> function. The other optional <var>fmtparam</var>
keyword arguments can be given to override individual formatting
parameters in the current dialect. For more information about the
dialect and formatting parameters, see section <code>
csv-fmt-params.html#csv-fmt-params</code>, &#8220;Dialects and
Formatting Parameters&#8221; for details of these parameters. To
make it as easy as possible to interface with modules which
implement the DB API, the value <code>None</code> is written as the
empty string. While this isn't a reversible transformation, it
makes it easier to dump SQL NULL data values to CSV files without
preprocessing the data returned from a <code>cursor.fetch*()</code>
call. All other non-string data are stringified with <code>str</code> before being written.</p>
</dd>
<dt class="function" id="register_dialect"><b>register_dialect(name, dialect)</b> <tt class="nav"><a class="nav" href="csv.register_dialect" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Associate <var>dialect</var> with <var>name</var>. <var>
dialect</var> must be a subclass of <code>csv.Dialect</code>. <var>name</var> must be a
string or Unicode object.</p>
</dd>
<dt class="function" id="unregister_dialect"><b>unregister_dialect(name)</b> <tt class="nav"><a class="nav" href="csv.unregister_dialect" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Delete the dialect associated with <var>name</var> from the
dialect registry. An <a class="link" href="#Error"><code>Error</code></a> is
raised if <var>name</var> is not a registered dialect name.</p>
</dd>
<dt class="function" id="get_dialect"><b>get_dialect(name)</b> <tt class="nav"><a class="nav" href="csv.get_dialect" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Return the dialect associated with <var>name</var>. An <a class="link" href="#Error"><code>Error</code></a> is raised if <var>
name</var> is not a registered dialect name.</p>
</dd>
<dt class="function" id="list_dialects"><b>list_dialects()</b> <tt class="nav"><a class="nav" href="csv.list_dialects" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="function">
<p>Return the names of all registered dialects.</p>
</dd>
</dl><div class="text">
<p>The <code>csv</code> module defines the
following classes:</p>
</div>
<dl><dt class="class" id="DictReader"><b>class DictReader(csvfile[, fieldnames=None,[,
restkey=None[, restval=None[, dialect='excel'[, *args,
**kwds]]]]])</b> <tt class="nav"><a class="nav" href="csv.DictReader" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="class">
<p>Create an object which operates like a regular reader but maps
the information read into a dict whose keys are given by the
optional <var>fieldnames</var> parameter. If the <var>
fieldnames</var> parameter is omitted, the values in the first row
of the <var>csvfile</var> will be used as the fieldnames. If the
row read has fewer fields than the fieldnames sequence, the value
of <var>restval</var> will be used as the default value. If the row
read has more fields than the fieldnames sequence, the remaining
data is added as a sequence keyed by the value of <var>
restkey</var>. If the row read has fewer fields than the fieldnames
sequence, the remaining keys take the value of the optional <var>
restval</var> parameter. Any other optional or keyword arguments
are passed to the underlying <a class="link" href="#reader"><code>
reader</code></a> instance.</p>
</dd>
<dt class="class" id="DictWriter"><b>class DictWriter(csvfile, fieldnames[, restval=""[,
extrasaction='raise'[, dialect='excel'[, *args, **kwds]]]])</b> <tt class="nav"><a class="nav" href="csv.DictWriter" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="class">
<p>Create an object which operates like a regular writer but maps
dictionaries onto output rows. The <var>fieldnames</var> parameter
identifies the order in which values in the dictionary passed to
the <code>writerow</code> method are
written to the <var>csvfile</var>. The optional <var>restval</var>
parameter specifies the value to be written if the dictionary is
missing a key in <var>fieldnames</var>. If the dictionary passed to
the <code>writerow</code> method
contains a key not found in <var>fieldnames</var>, the optional
<var>extrasaction</var> parameter indicates what action to take. If
it is set to <code>'raise'</code> a <code>exceptions.ValueError</code> is
raised. If it is set to <code>'ignore'</code>, extra values in the
dictionary are ignored. Any other optional or keyword arguments are
passed to the underlying <a class="link" href="#writer"><code>
writer</code></a> instance.</p>

<p>Note that unlike the <a class="link" href="#DictReader"><code>
DictReader</code></a> class, the <var>fieldnames</var> parameter of the <a class="link" href="#DictWriter"><code>DictWriter</code></a> is not optional.
Since Python's <code>dict</code> objects
are not ordered, there is not enough information available to
deduce the order in which the row should be written to the <var>
csvfile</var>.</p>
</dd>
<dt class="class" id="Dialect"><b>class Dialect</b> <tt class="nav"><a class="nav" href="csv.Dialect" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="class">
<p>The <a class="link" href="#Dialect"><code>Dialect</code></a> class is a
container class relied on primarily for its attributes, which are
used to define the parameters for a specific <a class="link" href="#reader"><code>reader</code></a> or <a class="link" href="#writer"><code>writer</code></a> instance.</p>
</dd>
<dt class="class" id="Sniffer"><b>class Sniffer()</b> <tt class="nav"><a class="nav" href="csv.Sniffer" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="class">
<p>The <a class="link" href="#Sniffer"><code>Sniffer</code></a> class is
used to deduce the format of a CSV file.</p>
</dd>
</dl><div class="text">
<p>The <a class="link" href="#Sniffer"><code>Sniffer</code></a> class
provides a single method:</p>
</div>
<dl><dt class="method" id="Sniffer.sniff"><b>sniff(sample[,delimiters=None])</b> <tt class="nav"><a class="nav" href="csv.Sniffer.sniff" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="method">
<p>Analyze the given <var>sample</var> and return a <a class="link" href="#Dialect"><code>Dialect</code></a> subclass reflecting the parameters
found. If the optional <var>delimiters</var> parameter is given, it
is interpreted as a string containing possible valid delimiter
characters.</p>
</dd>
<dt class="method" id="Sniffer.has_header"><b>has_header(sample)</b> <tt class="nav"><a class="nav" href="csv.Sniffer.has_header" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="method">
<p>Analyze the sample text (presumed to be in CSV format) and
return <code>True</code> if the first row appears to be a series of
column headers.</p>
</dd>
</dl><div class="text">
<p>The <code>csv</code> module defines the
following constants:</p>
</div>
<dl><dt class="variable" id="QUOTE_ALL"><b>QUOTE_ALL</b> <tt class="nav"><a class="nav" href="csv.QUOTE_ALL" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="variable">
<p>Instructs <a class="link" href="#writer"><code>writer</code></a> objects
to quote all fields.</p>
</dd>
<dt class="variable" id="QUOTE_MINIMAL"><b>QUOTE_MINIMAL</b> <tt class="nav"><a class="nav" href="csv.QUOTE_MINIMAL" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="variable">
<p>Instructs <a class="link" href="#writer"><code>writer</code></a> objects
to only quote those fields which contain the current <var>
delimiter</var> or begin with the current <var>quotechar</var>.</p>
</dd>
<dt class="variable" id="QUOTE_NONNUMERIC"><b>QUOTE_NONNUMERIC</b> <tt class="nav"><a class="nav" href="csv.QUOTE_NONNUMERIC" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="variable">
<p>Instructs <a class="link" href="#writer"><code>writer</code></a> objects
to quote all non-numeric fields.</p>
</dd>
<dt class="variable" id="QUOTE_NONE"><b>QUOTE_NONE</b> <tt class="nav"><a class="nav" href="csv.QUOTE_NONE" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="variable">
<p>Instructs <a class="link" href="#writer"><code>writer</code></a> objects
to never quote fields. When the current <var>delimiter</var> occurs
in output data it is preceded by the current <var>escapechar</var>
character. When <code>QUOTE_NONE</code> is in effect, it is an
error not to have a single-character <var>escapechar</var> defined,
even if no data to be written contains the <var>delimiter</var>
character.</p>
</dd>
</dl><div class="text">
<p>The <code>csv</code> module defines the
following exception:</p>
</div>
<dl><dt class="exception" id="Error"><b>exception Error</b> <tt class="nav"><a class="nav" href="csv.Error" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="exception">
<p>Raised by any of the functions when an error is detected.</p>
</dd>
</dl><div class="text">
<h2 id="dialects-and-formatting-parameters">Dialects and Formatting Parameters <a class="nav" href="#dialects-and-formatting-parameters">#</a></h2>

<p>To make it easier to specify the format of input and output
records, specific formatting parameters are grouped together into
dialects. A dialect is a subclass of the <a class="link" href="#Dialect"><code>Dialect</code></a> class having a set of specific
methods and a single <code>
validate</code> method. When creating <a class="link" href="#reader"><code>reader</code></a> or <a class="link" href="#writer"><code>writer</code></a> objects, the programmer can specify a
string or a subclass of the <a class="link" href="#Dialect"><code>
Dialect</code></a> class as the dialect parameter. In addition to, or
instead of, the <var>dialect</var> parameter, the programmer can
also specify individual formatting parameters, which have the same
names as the attributes defined below for the <a class="link" href="#Dialect"><code>Dialect</code></a> class.</p>

<p>Dialects support the following attributes:</p>
</div>
<dl><dt class="attribute" id="Sniffer.delimiter"><b>delimiter</b> <tt class="nav"><a class="nav" href="csv.Sniffer.delimiter" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>A one-character string used to separate fields. It defaults to
<code>','</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.doublequote"><b>doublequote</b> <tt class="nav"><a class="nav" href="csv.Sniffer.doublequote" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>Controls how instances of <var>quotechar</var> appearing inside
a field should be themselves be quoted. When <code>True</code>, the
character is doubled. When <code>False</code>, the <var>
escapechar</var> must be a one-character string which is used as a
prefix to the <var>quotechar</var>. It defaults to <code>
True</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.escapechar"><b>escapechar</b> <tt class="nav"><a class="nav" href="csv.Sniffer.escapechar" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>A one-character string used to escape the <var>delimiter</var>
if <var>quoting</var> is set to <code>QUOTE_NONE</code>. It
defaults to <code>None</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.lineterminator"><b>lineterminator</b> <tt class="nav"><a class="nav" href="csv.Sniffer.lineterminator" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>The string used to terminate lines in the CSV file. It defaults
to <code>'\r\n'</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.quotechar"><b>quotechar</b> <tt class="nav"><a class="nav" href="csv.Sniffer.quotechar" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>A one-character string used to quote elements containing the
<var>delimiter</var> or which start with the <var>quotechar</var>.
It defaults to <code>'"'</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.quoting"><b>quoting</b> <tt class="nav"><a class="nav" href="csv.Sniffer.quoting" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>Controls when quotes should be generated by the writer. It can
take on any of the <code>QUOTE_*</code> constants (see section <code>
csv-contents.html#csv-contents</code>) and defaults to <code>
QUOTE_MINIMAL</code>.</p>
</dd>
<dt class="attribute" id="Sniffer.skipinitialspace"><b>skipinitialspace</b> <tt class="nav"><a class="nav" href="csv.Sniffer.skipinitialspace" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="attribute">
<p>When <code>True</code>, whitespace immediately following the
<var>delimiter</var> is ignored. The default is <code>
False</code>.</p>
</dd>
</dl><div class="text">
<h2 id="reader-objects">Reader Objects <a class="nav" href="#reader-objects">#</a></h2>

<p>Reader objects (<a class="link" href="#DictReader"><code>DictReader</code></a> instances and objects
returned by the <a class="link" href="#reader"><code>reader</code></a>
function) have the following public methods:</p>
</div>
<dl><dt class="method" id="Reader.next"><b>next()</b> <tt class="nav"><a class="nav" href="csv.Reader.next" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="method">
<p>Return the next row of the reader's iterable object as a list,
parsed according to the current dialect.</p>
</dd>
</dl><div class="text">
<h2 id="writer-objects">Writer Objects <a class="nav" href="#writer-objects">#</a></h2>

<p><code>Writer</code> objects (<a class="link" href="#DictWriter"><code>DictWriter</code></a> instances and
objects returned by the <a class="link" href="#writer"><code>
writer</code></a> function) have the following public methods. A <var>
row</var> must be a sequence of strings or numbers for <code>Writer</code> objects and a dictionary
mapping fieldnames to strings or numbers (by passing them through
<code>str</code> first) for <a class="link" href="#DictWriter"><code>DictWriter</code></a> objects. Note that complex
numbers are written out surrounded by parens. This may cause some
problems for other programs which read CSV files (assuming they
support complex numbers at all).</p>
</div>
<dl><dt class="method" id="Writer.writerow"><b>writerow(row)</b> <tt class="nav"><a class="nav" href="csv.Writer.writerow" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="method">
<p>Write the <var>row</var> parameter to the writer's file object,
formatted according to the current dialect.</p>
</dd>
<dt class="method" id="Writer.writerows"><b>writerows(rows)</b> <tt class="nav"><a class="nav" href="csv.Writer.writerows" title="bookmark">#</a>|<a class="nav" href="#" title="edit/suggest changes">!</a>|<a class="nav" href="#" title="search for related examples">&amp;</a></tt></dt>

<dd class="method">
<p>Write all the <var>rows</var> parameters (a list of <var>
row</var> objects as described above) to the writer's file object,
formatted according to the current dialect.</p>
</dd>
</dl><div class="text">
<h2 id="examples">Examples <a class="nav" href="#examples">#</a></h2>

<p>The &#8220;Hello, world&#8221; of csv reading is</p>

<pre>
import csv
reader = csv.reader(open("some.csv", "rb"))
for row in reader:
    print row
</pre>

<p>To print just the first and last columns of each row try</p>

<pre>
import csv
reader = csv.reader(open("some.csv", "rb"))
for row in reader:
    print row[0], row[-1]
</pre>

<p>The corresponding simplest possible writing example is</p>

<pre>
import csv
writer = csv.writer(open("some.csv", "wb"))
for row in someiterable:
    writer.writerow(row)
</pre>
</div>
</div></body></html>
